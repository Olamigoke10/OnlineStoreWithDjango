{% extends 'main.html' %}

{% block content %}
<main class="layout layout--3">
  <div class="container">
    <h1>Restaurant Menu</h1>

    <!-- Button Group for Meal Categories -->
    <div class="btn-group" role="group" aria-label="Meal Categories">
      <button class="btn btn-outline-primary" onclick="showAllMeals()">Show All</button>
      {% for meal in meals %}
        <button class="btn btn-outline-secondary" onclick="showMeals('{{ meal.0 }}')">{{ meal.1 }}</button>
      {% endfor %}
    </div>

    <!-- Meal Sections -->
    <div class="mt-3">
      {% for meal in meals %}
        <div class="meal-section" data-meal-type="{{ meal.0 }}" style="display: none;">
          <h2 class="pt-5">{{ meal.1 }}</h2>
          <ul class="list-group list-group-flush">
            {% for row in object_list %}
              {% if row.meal_type == meal.0 %}
                <li class="list-group-item d-flex justify-content-between align-items-center border-0 pb-0">
                  <a href="{% url 'menu_item_detail' row.pk %}">
                    {% if row.status == 0 %}
                      <b><del>{{ row.meal }}</del></b>
                    {% else %}
                      <b>{{ row.meal }}</b>
                    {% endif %}
                  </a>
                  {% if row.image %}
                    <img src="{{ row.image.url }}" alt="{{ row.meal }}" style="width: 100px; height: auto;">
                  {% endif %}
                  <span class="badge bg-primary rounded-pill">{{ row.price }}</span>
                  <span><a href="{% url 'add_to_cart' row.pk %}">Add</a></span>
                </li>
                <li class="list-group-item pt-0">
                  <p>{{ row.description }}</p>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    </div>

    <a href="{% url 'view_cart' %}">Cart</a>

    {% if user.is_authenticated and user.is_staff %}
      <a href="{% url 'order_view' %}">Orders</a>
      <a href="{% url 'video_list' %}">Video</a>
    {% endif %}
  </div>
</main>

<script>
  // Function to show all meals
  function showAllMeals() {
    var mealSections = document.getElementsByClassName("meal-section");
    for (var i = 0; i < mealSections.length; i++) {
      mealSections[i].style.display = "block";
    }
  }

  // Function to show specific meal category
  function showMeals(mealType) {
    var mealSections = document.getElementsByClassName("meal-section");
    for (var i = 0; i < mealSections.length; i++) {
      if (mealSections[i].getAttribute("data-meal-type") === mealType) {
        mealSections[i].style.display = "block";
      } else {
        mealSections[i].style.display = "none";
      }
    }
  }

  // Initially show all meals
  document.addEventListener("DOMContentLoaded", function() {
    showAllMeals();
  });
</script>
{% endblock %}
